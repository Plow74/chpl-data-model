# Log into the "initial-machine" and generate the backup file
ssh initial-machine
cd chpl-data-model/maint
./dump.sh $DB openchpl_dev
exit

# Copy the backup file from the initial machine to the target machine
scp initial-machine:chpl-data-model/maint/openchpl.backup target-machine:chpl-data-model/maint/openchpl.backup

# Log into the target machine and load the data file
ssh target-machine
cd chpl-data-model/maint
./load.sh $DB openchpl_dev
To disable all users (except admin):
  psql -U openchpl_dev -h $DB -f disable-users.sql openchpl
psql -U openchpl_dev -h $DB -f users.sql openchpl

# Update the target machine with whatever is "new" as per git
cd ..
psql -U openchpl_dev -h $DB -f v-next.sql openchpl;
psql -U openchpl -h $DB -c analyze;

# Notes:
# If loading on live, consider stop/starting tomcat
  service tomcat8 stop
  service tomcat8 start

# Edit users.sql file to add any users w/encrypted passwords and the things they should be managers of.

# Make sure openchpl_dev is a user in the system, something like:
CREATE ROLE openchpl_dev LOGIN
  ENCRYPTED PASSWORD 'md5cf8270a3cc591bdefa97b25a3981ef9e'
  NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE NOREPLICATION;

# And make sure the openchpl database is owned by openchpl_dev:
CREATE DATABASE openchpl
  WITH OWNER = openchpl_dev
       ENCODING = 'UTF8'
       TABLESPACE = pg_default
       LC_COLLATE = 'English_United States.1252'
       LC_CTYPE = 'English_United States.1252'
       CONNECTION LIMIT = -1;
